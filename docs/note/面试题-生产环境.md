# 面试题-生产环境



## 1. 线上修改配置文件

1. springcloud config+RabbitMQ；

2. Java 提供了 WatchService 接口，这个接口是利用操作系统本身的文件监控器对目录和文件进行监控，当被监控对象发生变化时，会有信号通知，从而可以高效的发现变化。

   这种方式大致的原理：先根据操作系统 new 一个监控器（ WatchService ），然后选择要监控的配置文件所在目录或文件，然后订阅要监控的事件，例如创建、删除、编辑，最后向被监控位置注册这个监控器。一旦触发对应我们所订阅的事件时，执行相应的逻辑即可；

3. 使用 DB , 然后每个服务定时刷新一次

4. 使用 Redis, 进行消息发布订阅

5. 在需要刷新的Bean上添加@RefreshScope注解。

6. 负载切换

7. arthas热更新代码

8. zk注册watch

   

 

## 2. 线上修改bug

1. **arthas** 监控jar运行程序
2. **arthas** jad反编译bug类
3. vim修改并javac编译出新的class文件
4. **arthas** redefine重新加载编译后的class文件

## 3. mysql修改表结构